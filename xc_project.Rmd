---
title: "Extra Credit Project"
author: "Marc Luiz, Nelly Shieh, Jeff Nguyen"
date: "18/09/2020"
output:
  pdf_document: default
  html_document:
    code_folding: "hide"
  word_document: default
---
```{r include = FALSE}
#knitr::opts_chunk$set(echo=FALSE)
```

**Coitegration Analysis of Different Financial Markets**  
**University of Southern California**  
**Marshall School of Business**  
**FBE 543 Forecasting and Risk Analysis**  
**Spring 2021**  
**Directed by Professor Mohammad Safarzadeh**   
  
# Topic:  
Using major stock indices for the United States (S&P500), Unite Kingdom (FTSE100), Germany (DAX), and France (CAC40) show that US and European financial markets conintegrate.  

# Method:  
**Reviewing cointegration condition:**    

Consider 2 time series variables $Y$ and $X$. We have the regression equation as follow:  

\begin{equation}
  \begin{aligned}
    Y_t =& \beta_0 + \beta_1 X_t + \epsilon_t  \\
  \end{aligned}
\end{equation}
  
The cointegration is such that if $X$ and $Y$ are both non-stationary variables AND $\epsilon$ is a stationary variable, then $X$ and $Y$ cointegrate, i.e. they "move together" in the long run.  

Thus, our primary methodology is as follow:  

## 1. Test indices for stationarity:  
Test representative stock indices in the United States (S&P 500), the United Kingdom (FTSE), Germany (DAX) and France (CAC40) for stationarity.  
To execute this task, for each indices, we run the Augmented Dickey-Fuller Test (A)DF, which hypothesizes that a unit root is present in an autoregressive model. The intuition is such that if a variable is stationary, it tends to a constant mean--i.e. the values oscillates/ alternate for large to small. As a result, the process is not a random walk, i.e. nonstationary.

## 2. Test error term for stationarity:  
Should the regressed result confirm non-stationarity, check whether the error term of the regression $\epsilon$ are non-stationary variables. If they are, then the indices cointegrate.  
  
First we check for the common issue with time series data: positive autocorrelation by running Durbin-Watson Test. If autocorrelation exists, we add the first order autoregressive term $AR(1)$ into the model and subsequently $AR(2)$ as necessary.

Then, we run (A)DF test as above to test the error term for stationarity--not having a unit root in the (A)DF test.  

# Data Analysis  

For this model, we use 20 years of data from March 2001 to March 2021.  
  
## Downloading data  

```{r}
library(quantmod)

# Set start date and end date of data
start_date <- "2001-01-01"
end_date <- "2021-03-18"

# Get data
getSymbols("^GSPC", src = "yahoo", , from = start_date, to = end_date) # S&P 500
getSymbols("^FTSE", src = "yahoo", , from = start_date, to = end_date) # S&P 500
getSymbols("^GDAXI", src = "yahoo", , from = start_date, to = end_date) # S&P 500
getSymbols("^FCHI", src = "yahoo", , from = start_date, to = end_date) # S&P 500

# Adjusted Prices
adjGSPC_mo <- to.monthly(GSPC)$GSPC.Adjusted
adjFTSE_mo <- to.monthly(FTSE)$FTSE.Adjusted
adjGDAXI_mo <- to.monthly(GDAXI)$GDAXI.Adjusted
adjFCHI_mo <- to.monthly(FCHI)$FCHI.Adjusted
```
  
## Data Observation:  

Observing each indices:  
```{r}
plot(adjGSPC_mo, main="S&P500", col="Red")
plot(adjFTSE_mo, main="FTSE100", col="Blue")
plot(adjGDAXI_mo, main="DAX30", col="Chocolate")
plot(adjFCHI_mo, main="CAC40", col="Purple")
```
  
**Remarks**  
**1. Seasonal Trend:**  
All display similar seasonal trend with up and down spikes in price months after months.  
**2. Cyclical Trend:**  
All are affected by business cycle with similar peaks and troughs. The S&P 500 has less prominent troughs compared to those of other indices.  
**3. Auto-correlation:**  
All behave similar in this regard where both rises for some times when they rise and vice versa.  
**4. Randomness:**  
Their prices are unpredictable via inspection.  
**5. Time:**  
All follows similar time trend.  
**6. Structural Break:**  
We can see several structural breaks conincided with the 2001 Tech Bust and the 2007 Great Financial Crisis.  
**7. Outliers:**  
All have multiple outliers.  
  
In summary, we can observe clear trend and non-constant drift from all indices.  

## Testing for Stationarity for indices
  
Per methodology, we run Augmented Dickey Fuller Test for each indices. Recall that the null hypothesis for Dickey-Fuller Test is that a unit root is present in our autoregressive model, meaning the variable is a non-stationary variable.  
  
### S&P 500  

```{r}
library(aTSA)

adf.test(adjGSPC_mo)
```
  
We can observe $p-value = .99 > .05$. Thus, we fail to reject the null hypothesis. In other words, S&P 500 monthly adjusted closing price has a unit root and therefore, is a non-stationary variable.
  

### FTSE 100  

```{r}
adf.test(adjFTSE_mo)
```
  
We can observe $p-value > .05$. Thus, we fail to reject the null hypothesis. In other words, FTSE100 monthly adjusted closing price has a unit root and therefore, is a non-stationary variable.
  
### DAX 30  

```{r}
adf.test(adjGDAXI_mo)
```
  
We can observe $p-value = .99 > .05$. Thus, we fail to reject the null hypothesis. In other words, DAX 30 monthly adjusted closing price has a unit root and therefore, is a non-stationary variable.
  
### CAC 40  

```{r}
adf.test(adjFCHI_mo)
```
  
We can observe $p-value > .05$. Thus, we fail to reject the null hypothesis. In other words, CAC 40 monthly adjusted closing price has a unit root and therefore, is a non-stationary variable.
  
## Testing for stationarity for error term  
